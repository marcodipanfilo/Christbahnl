<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Christbahndl</title>
  <style>
    button {
      font-size: 24px;
      width: 120px;
      height: 100px;
      margin: 5px;
      touch-action: manipulation;
    }

    #resetButton {
      font-size: 24px;
      width: 100%;
      height: 100px;
    }

    #sum {
      font-size: 48px;
    }

    .itemButton {
      width: 120px;
      height: 100px;
      font-size: 20px;
      display: inline-block;
      margin-right: 5px;
      
    }

    #selectedItems {
      display: flex;
      flex-wrap: wrap;
      gap: 0px;
    }

    .fixed {

    }

    #totalAmount {
      box-sizing: border-box;
      padding: 15px;
      position: fixed;
      top: 0;
      right: 0;
      width: 33.333%;
      /* 1/3 of the page width */
      height: 100%;
      /* Takes up the full height of the page */
      background-color: lightgray;
      /* To ensure content visibility */
      z-index: 1;
      overflow-y: auto;
    }

    #mainContent {
      width: 66.667%;
      /* Remaining 2/3 of the page */
      margin-right: 33.333%;
      /* Prevent overlap with the fixed column */
    }

  </style>
</head>

<body>

  <div id="mainContent">

    <h1>Getränke</h1>
    <div id="drinks">
      <button data-price="250" onclick="addItem('Apfelsaft', 250)">Apfelsaft<br>2,50€</button>
      <button data-price="400" onclick="addItem('Weißwein', 400)">Weißwein<br>4,00€</button>
      <button data-price="350" onclick="addItem('Hugo', 350)">Hugo<br>3,50€</button>
      <button data-price="380" onclick="addItem('Aperol Spritz', 380)">Aperol Spritz<br>3,80€</button>
      <button data-price="500" onclick="addItem('Obstler', 500)">Obstler<br>5,00€</button>
      <button data-price="280" onclick="addItem('Zitronenwasser', 280)">Zitronenwasser<br>2,80€</button>
      <button data-price="450" onclick="addItem('Rotwein', 450)">Rotwein<br>4,50€</button>
    </div>

    <h1>Essen</h1>
    <div id="food">
      <button data-price="1200" onclick="addItem('Speckknödel', 1200)">Speckknödel<br>12,00€</button>
      <button data-price="1400" onclick="addItem('Kaiserschmarrn', 1400)">Kaiserschmarrn<br>14,00€</button>
      <button data-price="1600" onclick="addItem('Schlutzkrapfen', 1600)">Schlutzkrapfen<br>16,00€</button>
      <button data-price="1800" onclick="addItem('Gulaschsuppe', 1800)">Gulaschsuppe<br>18,00€</button>
      <button data-price="2000" onclick="addItem('Tiroler Gröstl', 2000)">Tiroler Gröstl<br>20,00€</button>
      <button data-price="2200" onclick="addItem('Apfelstrudel', 2200)">Apfelstrudel<br>22,00€</button>
      <button data-price="2400" onclick="addItem('Zwiebelrostbraten', 2400)">Zwiebelrostbraten<br>24,00€</button>
      <button data-price="2600" onclick="addItem('Käsenocken', 2600)">Käsenocken<br>26,00€</button>
    </div>
  </div>

  <div id="totalAmount" class="fixed">
    <button id="resetButton" onclick="resetSelection()">Zurücksetzen</button>

    <h1>Gesamt</h1>
    <div id="sum">0,00€</div>

    <h1>Ausgewählte Artikel</h1>
    <div id="selectedItems"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>

  <script>
    let totalSum = 0;
    let itemCounts = {};

    function addItem(name, price) {
      totalSum += price;
      document.getElementById('sum').innerText = (totalSum / 100).toFixed(2) + '€';

      if (!itemCounts[name]) {
        itemCounts[name] = { count: 0, price: price };
      }
      itemCounts[name].count++;

      renderSelectedItems();
    }

    function removeItem(name, price) {
      if (itemCounts[name] && itemCounts[name].count > 0) {
        totalSum -= price;
        itemCounts[name].count--;
        if (itemCounts[name].count === 0) {
          delete itemCounts[name];
        }
      }

      document.getElementById('sum').innerText = (totalSum / 100).toFixed(2) + '€';
      renderSelectedItems();
    }

    function insertSoftHyphens(str, n) {
      return str.replace(new RegExp(`(.{${n}})`, 'g'), "$1&shy;");
    }

    function renderSelectedItems() {
      let itemList = '';
      for (const [name, item] of Object.entries(itemCounts)) {
        const hyphenatedName = insertSoftHyphens(name, 10);
        itemList += `<button id="${name.replace(/\s+/g, '')}-btn" class="itemButton" onclick="removeItem('${name}', ${item.price})">${hyphenatedName} (x${item.count})</button><br>`;
      }
      document.getElementById('selectedItems').innerHTML = itemList;
    }

    function resetSelection() {
      totalSum = 0;
      itemCounts = {};
      document.getElementById('sum').innerText = '0,00€';
      document.getElementById('selectedItems').innerHTML = '';
    }

    if ('addEventListener' in document) {
      document.addEventListener('DOMContentLoaded', function () {
        FastClick.attach(document.body);
      }, false);
    }

    document.addEventListener("DOMContentLoaded", function() {
      const buttons = document.querySelectorAll('button');
      buttons.forEach(button => {
        for(let i = 0; i < button.childNodes.length; i++) {
          const child = button.childNodes[i];
          // Only manipulate text nodes (nodeType === 3)
          if (child.nodeType === 3 && child.nodeValue.trim().length > 0) {
            let text = child.nodeValue;
            if (text.length > 7) {
              let parts = [];
              for (let j = 0; j < text.length; j += 7) {
                parts.push(text.slice(j, j + 7));
              }
              child.nodeValue = parts.join("­"); // inserted a soft hyphen between the quotes
            }
          }
        }
      });
    });


  </script>
</body>

</html>