<!DOCTYPE html>
<html>

<head>
  <style>
    .download-button {
  font-size: 20px;
  padding: 15px 25px;
  margin-top: 20px;
  cursor: pointer;
}
  </style>
  <meta charset="UTF-8" name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>JSON Editor</title>
  <script>
    let menuJson = { menu: [] };

    window.addEventListener('load', () => {
      // Fetch current menu items
      fetch('https://raw.githubusercontent.com/marcodipanfilo/Christbahnl/fetch_data_json/menu.json') // Replace with your actual URL
        .then(response => response.json())
        .then(data => {
          menuJson = data;
          displayMenu();
        });
    });

    function displayMenu() {
      const menuDiv = document.getElementById('menuDiv');
      menuDiv.innerHTML = '';

      menuJson.menu.forEach((categoryObj, categoryIndex) => {
        const categoryTitle = document.createElement('h2');
        categoryTitle.textContent = categoryObj.category;
        menuDiv.appendChild(categoryTitle);

        categoryObj.items.forEach((item, itemIndex) => {
          const itemDiv = document.createElement('div');
          itemDiv.innerHTML = `
        <span>${item.name} - â‚¬${item.price}</span>
        <button onclick="editItem(${categoryIndex}, ${itemIndex})">Edit</button>
        <button onclick="deleteItem(${categoryIndex}, ${itemIndex})">Delete</button>
      `;
          menuDiv.appendChild(itemDiv);
        });

        // Add a "New Item" button at the end of each category
        const newItemButton = document.createElement('button');
        newItemButton.textContent = 'Add New Item';
        newItemButton.onclick = function () { addItem(categoryIndex); };
        menuDiv.appendChild(newItemButton);
      });
    }

    function addItem(categoryIndex) {
      const name = prompt("Enter new item name");
      const price = prompt("Enter new item price");

      if (name && price) {
        const newItem = { name, price };
        menuJson.menu[categoryIndex].items.push(newItem);
        displayMenu();
      }
    }


    function editItem(categoryIndex, itemIndex) {
      const name = prompt("Enter new name", menuJson.menu[categoryIndex].items[itemIndex].name);
      const price = prompt("Enter new price", menuJson.menu[categoryIndex].items[itemIndex].price);

      menuJson.menu[categoryIndex].items[itemIndex].name = name;
      menuJson.menu[categoryIndex].items[itemIndex].price = price;

      displayMenu();
    }

    function deleteItem(categoryIndex, itemIndex) {
      if (confirm('Are you sure you want to delete this item?')) {
        menuJson.menu[categoryIndex].items.splice(itemIndex, 1);
        displayMenu();
      }
    }

    function download() {
      const data = JSON.stringify(menuJson, null, 2);
      const blob = new Blob([data], { type: 'application/json' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');

      a.style.display = 'none';
      a.href = url;
      a.download = 'menu.json';

      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(url);
    }
  </script>
</head>

<body>

  <h1>Edit Menu JSON</h1>

  <div id="menuDiv">
    <!-- Current items will be displayed here -->
  </div>

  <button onclick="download()" class="download-button" id="downloadButton">Download JSON</button>

</body>

</html>